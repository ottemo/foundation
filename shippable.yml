language: go
go:
    - 1.5.3

env:
    global:
        - SLACK_ORG=Ottemo PROJECT=Foundation
        - secure: T2ImzTpns/H12TPzWD+/XYWBJzvLdIdBj2rzO7EgCezxBRk3EcixCCcj6ImXKxk7kyCMHJR/fALjoE7u7elHG9Y+TmtR7useu95TMVekO66RD702jrEu4LA7tUGvDfBzTw8Dr4PVeCjr0NFQlJ/z1XHk9knrsHEXydHRtQ4ciN/DTw4M1yVImp3VXYMpOePCGIfjcYA20M8/ZvTZA9Nv5f/eBcGZbPLsNCdvMasUEekWwpZzJvXycX7tS7EYc5kUZdqzpHpToY1/HYLtcLm4qmILUahWiaMKAYloA0nT/FCUcPpZLCOf0hhm9nNaEuE1YfA/3anAhBu89rqqSPzM5Q==

build:

    ci:
        - sudo apt-get install bzr -y
        - go version

    on_failure:
        - python bin/slack_notifier.py --org $SLACK_ORG --project $PROJECT --token $SLACK_TOKEN

    on_success:
        - REMOTE_HOST=rk.staging.ottemo.io bash bin/deploy.sh
        - REMOTE_HOST=kg.staging.ottemo.io bash bin/deploy.sh
        - REMOTE_HOST=mp.staging.ottemo.io bash bin/deploy.sh
        - REMOTE_HOST=demo.staging.ottemo.io bash bin/deploy.sh
        - REMOTE_HOST=sb.staging.ottemo.io bash bin/deploy.sh
        - REMOTE_HOST=scs.staging.ottemo.io bash bin/deploy.sh
        - REMOTE_HOST=sg.staging.ottemo.io bash bin/deploy.sh
        - REMOTE_HOST=gk.staging.ottemo.io bash bin/deploy.sh
        - python bin/slack_notifier.py --org $SLACK_ORG --project $PROJECT --token $SLACK_TOKEN -s


# only build develop
branches:

    only:
        - develop

integrations:

    notifications:

        - integrationName: email
          type: email
          on_success: never
          on_failure: never
          on_pull_request: never
